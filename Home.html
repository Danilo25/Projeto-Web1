<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Lista de Tarefas</title>
    <style>
        .completed {
            text-decoration: line-through;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 20px;
            border: 1px solid #ccc;
        }

        .modal.show {
            display: block;
        }
    </style>
</head>

<body>
    <h1>Lista de Tarefas</h1>

    <form id="task-form">
        <input type="text" id="task-input" placeholder="Adicionar nova tarefa" required>
        <button type="submit">Adicionar</button>
    </form>

    <ul id="task-list"></ul>

    <div id="modal" class="modal">
        <h2>Opções da Tarefa</h2>
        <button id="delete-task">Excluir</button>
        <button id="complete-task">Concluir</button>
    </div>

    <script>
        // Carregar as tarefas existentes do arquivo JSON
        var tasks = localStorage.getItem('tasks') ? JSON.parse(localStorage.getItem('tasks')) : [];

        // Variáveis para a manipulação da tela modal
        var modal = document.getElementById('modal');
        var deleteTaskBtn = document.getElementById('delete-task');
        var completeTaskBtn = document.getElementById('complete-task');

        // Função para atualizar a exibição das tarefas na página
        function renderTasks() {
            var taskList = document.getElementById('task-list');
            taskList.innerHTML = '';

            tasks.forEach(function (task, index) {
                var taskItem = document.createElement('li');
                var taskText = document.createElement('span');
                taskText.innerText = task.text;

                // Marcar como concluída
                if (task.completed) {
                    taskText.classList.add('completed');
                }

                // Abrir a tela modal ao clicar na tarefa
                taskText.addEventListener('click', function () {
                    modal.classList.add('show');

                    // Ação de excluir tarefa
                    deleteTaskBtn.addEventListener('click', function () {
                        tasks.splice(index, 1);
                        saveTasks();
                        renderTasks();
                        closeModal();
                    });

                    // Verificar se a tarefa está concluída
                    if (task.completed) {
                        // Ação de desmarcar tarefa concluída
                        completeTaskBtn.textContent = 'Desmarcar';
                        completeTaskBtn.addEventListener('click', function () {
                            task.completed = false;
                            saveTasks();
                            renderTasks();
                            closeModal();
                        });
                    } else {
                        // Ação de marcar tarefa como concluída
                        completeTaskBtn.textContent = 'Concluir';
                        completeTaskBtn.addEventListener('click', function () {
                            task.completed = true;
                            saveTasks();
                            renderTasks();
                            closeModal();
                        });
                    }
                });


                taskItem.appendChild(taskText);
                taskList.appendChild(taskItem);
            });
        }

        // Função para fechar a tela modal
        function closeModal() {
            modal.classList.remove('show');
            deleteTaskBtn.removeEventListener('click', null);
            completeTaskBtn.removeEventListener('click', null);
        }

        // Função para adicionar uma nova tarefa
        document.getElementById('task-form').addEventListener('submit', function (event) {
            event.preventDefault();
            var taskInput = document.getElementById('task-input');
            var taskText = taskInput.value.trim();

            if (taskText !== '') {
                tasks.push({ text: taskText, completed: false });
                saveTasks();
                taskInput.value = '';
                renderTasks();
            }
        });

        // Função para salvar as tarefas no arquivo JSON
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // Renderizar as tarefas na página ao carregar
        renderTasks();
    </script>
</body>

</html>